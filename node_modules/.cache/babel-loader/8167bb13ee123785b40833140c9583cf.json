{"ast":null,"code":"import React,{useCallback,useEffect,useMemo,useState}from'react';import{getApiUrl,getAuthHeaders}from'../config';import{useAuth}from'../context/AuthContext';import{useToast}from'../context/ToastContext';import{SkeletonTable}from'../components/SkeletonLoader';import EmptyState from'../components/EmptyState';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Timetable(){const{token}=useAuth();const toast=useToast();const[teacherCode,setTeacherCode]=useState('TCH2025');const[day,setDay]=useState('');const[entries,setEntries]=useState([]);const[loading,setLoading]=useState(false);const[error,setError]=useState('');const fetchTimetable=useCallback(async()=>{setLoading(true);setError('');try{const path=\"/midland/users/timetables/teacher/\".concat(encodeURIComponent(teacherCode));const url=getApiUrl(path);const res=await fetch(url,{headers:getAuthHeaders(token)});if(!res.ok){throw new Error(\"HTTP \".concat(res.status));}const data=await res.json();setEntries(Array.isArray(data)?data:[]);}catch(err){const errorMsg=err.message||'Failed to load timetable';setError(errorMsg);toast.error(errorMsg);}finally{setLoading(false);}},[teacherCode,token,toast]);useEffect(()=>{fetchTimetable();},[fetchTimetable]);const days=useMemo(()=>Array.from(new Set(entries.map(e=>e.dayOfWeek))),[entries]);const filtered=useMemo(()=>{const d=day.trim();return entries.filter(e=>!d||e.dayOfWeek===d).sort((a,b)=>a.dayOfWeek.localeCompare(b.dayOfWeek)||a.periodNumber-b.periodNumber);},[entries,day]);return/*#__PURE__*/_jsxs(\"div\",{className:\"page timetable\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"page-header\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"header-main\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Timetable\"}),/*#__PURE__*/_jsx(\"div\",{className:\"meta\",children:loading?'Loadingâ€¦':\"\".concat(filtered.length,\" periods\")})]})}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-error\",children:error}),/*#__PURE__*/_jsxs(\"div\",{className:\"filters\",children:[/*#__PURE__*/_jsx(\"input\",{value:teacherCode,onChange:e=>setTeacherCode(e.target.value),placeholder:\"Teacher Code (e.g., TCH2025)\",className:\"filter-input\"}),/*#__PURE__*/_jsxs(\"select\",{value:day,onChange:e=>setDay(e.target.value),disabled:loading,className:\"filter-select\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Days\"}),days.map(d=>/*#__PURE__*/_jsx(\"option\",{value:d,children:d},d))]})]}),loading?/*#__PURE__*/_jsx(SkeletonTable,{rows:5,columns:7}):filtered.length===0?/*#__PURE__*/_jsx(EmptyState,{type:\"timetable\"}):/*#__PURE__*/_jsx(\"div\",{className:\"table-container\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"data-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Day\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Period\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Time\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Subject\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Class\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Section\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Room\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:filtered.map((entry,idx)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:entry.dayOfWeek||'-'}),/*#__PURE__*/_jsx(\"td\",{children:entry.periodNumber||'-'}),/*#__PURE__*/_jsx(\"td\",{children:entry.startTime&&entry.endTime?\"\".concat(entry.startTime,\" - \").concat(entry.endTime):'-'}),/*#__PURE__*/_jsx(\"td\",{children:entry.subjectName||entry.subjectCode||'-'}),/*#__PURE__*/_jsx(\"td\",{children:entry.gradeLevel||'-'}),/*#__PURE__*/_jsx(\"td\",{children:entry.section||'-'}),/*#__PURE__*/_jsx(\"td\",{children:entry.roomNumber||'-'})]},idx))})]})})]});}","map":null,"metadata":{},"sourceType":"module"}