{"ast":null,"code":"import React,{useEffect,useState,useMemo}from'react';import{useParams,useNavigate}from'react-router-dom';import{getApiUrl,getAuthHeaders}from'../../config';import{useAuth}from'../../context/AuthContext';import{useToast}from'../../context/ToastContext';import{SkeletonProfile}from'../../components/SkeletonLoader';import{FiEdit2,FiArrowLeft,FiPhone,FiMail,FiHome,FiCalendar,FiTag,FiHash,FiUser,FiBookOpen,FiPhoneCall,FiUsers}from'react-icons/fi';import StatusBadge from'../../components/StatusBadge';import'./StudentProfile.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function StudentProfile(){const{id}=useParams();const navigate=useNavigate();const{token}=useAuth();const toast=useToast();const[student,setStudent]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const[activeTab,setActiveTab]=useState('basic');useEffect(()=>{let isMounted=true;async function fetchStudent(){setLoading(true);setError('');try{let studentData=null;try{const admissionUrl=getApiUrl(\"/midland/admin/students/admission/\".concat(id));const admissionRes=await fetch(admissionUrl,{headers:getAuthHeaders(token)});if(admissionRes.ok){studentData=await admissionRes.json();}}catch(err){// Fall through to fallback\n}if(!studentData){const allUrl=getApiUrl('/midland/admin/students/all');const allRes=await fetch(allUrl,{headers:getAuthHeaders(token)});if(!allRes.ok){throw new Error('Failed to load student');}const data=await allRes.json();const list=Array.isArray(data)?data:[];const match=list.find(s=>String(s.studentUid)===id||String(s.admissionNumber)===id||String(s.rollNo)===id||String(s.schoolEmail)===id||String(s.personalEmail)===id);studentData=match||null;}if(isMounted){setStudent(studentData);if(!studentData){setError('Student not found');toast.error('Student not found');}}}catch(err){const errorMsg=err.message||'Failed to load student';if(isMounted)setError(errorMsg);toast.error(errorMsg);}finally{if(isMounted)setLoading(false);}}fetchStudent();return()=>{isMounted=false;};},[id,token,toast]);const initials=useMemo(()=>{const name=((student===null||student===void 0?void 0:student.fullName)||'').trim();if(!name)return'??';const parts=name.split(/\\s+/);if(parts.length>=2){return(parts[0][0]+parts[parts.length-1][0]).toUpperCase();}return name.substring(0,2).toUpperCase();},[student]);if(loading)return/*#__PURE__*/_jsx(\"div\",{className:\"page\",children:/*#__PURE__*/_jsx(SkeletonProfile,{})});if(error||!student)return/*#__PURE__*/_jsx(\"div\",{className:\"page\",children:/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-error\",children:error||'Student not found'})});const primaryPhone=student.phoneNumber||'';const primaryEmail=student.schoolEmail||student.personalEmail||'';const phoneHref=primaryPhone?\"tel:\".concat(String(primaryPhone).replace(/\\s+/g,'')):null;const emailHref=primaryEmail?\"mailto:\".concat(primaryEmail):null;const tabs=[{id:'basic',label:'Basic',icon:FiUser},{id:'academic',label:'Academic',icon:FiBookOpen},{id:'contact',label:'Contact',icon:FiPhoneCall},{id:'guardian',label:'Guardian',icon:FiUsers}];return/*#__PURE__*/_jsxs(\"div\",{className:\"page student-profile-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile-header-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile-header-left\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back-button\",onClick:()=>navigate('/students'),children:/*#__PURE__*/_jsx(FiArrowLeft,{size:20})}),/*#__PURE__*/_jsx(\"h1\",{children:\"Student Profile\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn-secondary\",onClick:()=>navigate(\"/students/\".concat(id,\"/edit\")),children:[/*#__PURE__*/_jsx(FiEdit2,{size:16,style:{marginRight:8}}),\"Edit Profile\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-top-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"profile-avatar-large\",children:initials}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-info-main\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"profile-name\",children:student.fullName||'-'}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-badges\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-badge purple\",children:[/*#__PURE__*/_jsx(FiCalendar,{size:14}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Class \",student.gradeLevel||'-',\" \\u2022 Sec \",student.section||'-']})]}),/*#__PURE__*/_jsx(StatusBadge,{status:student.status||'Active'}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-badge orange\",children:[/*#__PURE__*/_jsx(FiHash,{size:14}),/*#__PURE__*/_jsxs(\"span\",{children:[\"# \",student.admissionNumber||student.rollNo||'-']})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"contact-cards\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"contact-card\",children:[/*#__PURE__*/_jsx(FiPhone,{size:18}),primaryPhone?/*#__PURE__*/_jsx(\"a\",{className:\"contact-card-link\",href:phoneHref,children:primaryPhone}):/*#__PURE__*/_jsx(\"span\",{children:\"N/A\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"contact-card\",children:[/*#__PURE__*/_jsx(FiMail,{size:18}),primaryEmail?/*#__PURE__*/_jsx(\"a\",{className:\"contact-card-link\",href:emailHref,children:primaryEmail}):/*#__PURE__*/_jsx(\"span\",{children:\"N/A\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"contact-card\",children:[/*#__PURE__*/_jsx(FiHome,{size:18}),/*#__PURE__*/_jsx(\"span\",{children:student.address||'N/A'})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-metrics-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"metric-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"metric-icon\",children:/*#__PURE__*/_jsx(FiCalendar,{size:20})}),/*#__PURE__*/_jsx(\"div\",{className:\"metric-label\",children:\"CLASS\"}),/*#__PURE__*/_jsx(\"div\",{className:\"metric-value\",children:student.gradeLevel||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"metric-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"metric-icon\",children:/*#__PURE__*/_jsx(FiCalendar,{size:20})}),/*#__PURE__*/_jsx(\"div\",{className:\"metric-label\",children:\"SECTION\"}),/*#__PURE__*/_jsx(\"div\",{className:\"metric-value\",children:student.section||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"metric-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"metric-icon\",children:/*#__PURE__*/_jsx(FiCalendar,{size:20})}),/*#__PURE__*/_jsx(\"div\",{className:\"metric-label\",children:\"ACADEMIC YEAR\"}),/*#__PURE__*/_jsx(\"div\",{className:\"metric-value\",children:student.academicYear||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"metric-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"metric-icon\",children:/*#__PURE__*/_jsx(FiTag,{size:20})}),/*#__PURE__*/_jsx(\"div\",{className:\"metric-label\",children:\"STATUS\"}),/*#__PURE__*/_jsx(\"div\",{className:\"metric-value\",children:student.status||'Active'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"metric-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"metric-icon\",children:/*#__PURE__*/_jsx(FiCalendar,{size:20})}),/*#__PURE__*/_jsx(\"div\",{className:\"metric-label\",children:\"ATTENDANCE\"}),/*#__PURE__*/_jsx(\"div\",{className:\"metric-value\",children:\"86%\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"metric-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"metric-icon\",children:/*#__PURE__*/_jsx(FiTag,{size:20})}),/*#__PURE__*/_jsx(\"div\",{className:\"metric-label\",children:\"FEES DUE\"}),/*#__PURE__*/_jsx(\"div\",{className:\"metric-value\",children:\"\\u20B9 0\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-content-layout\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile-tabs-section\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"profile-tabs\",children:tabs.map(tab=>{const TabIcon=tab.icon;return/*#__PURE__*/_jsxs(\"button\",{className:\"profile-tab \".concat(activeTab===tab.id?'active':''),onClick:()=>setActiveTab(tab.id),type:\"button\",children:[/*#__PURE__*/_jsx(TabIcon,{size:16}),/*#__PURE__*/_jsx(\"span\",{children:tab.label})]},tab.id);})}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-tab-content\",children:[activeTab==='basic'&&/*#__PURE__*/_jsxs(\"div\",{className:\"tab-panel\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-field-display\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Full Name\"}),/*#__PURE__*/_jsx(\"div\",{className:\"field-value\",children:student.fullName||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-field-display\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Gender\"}),/*#__PURE__*/_jsx(\"div\",{className:\"field-value\",children:student.gender||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-field-display\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Date of Birth\"}),/*#__PURE__*/_jsx(\"div\",{className:\"field-value\",children:student.dateOfBirth||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-field-display\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Blood Group\"}),/*#__PURE__*/_jsx(\"div\",{className:\"field-value\",children:student.bloodGroup||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-field-display\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Nationality\"}),/*#__PURE__*/_jsx(\"div\",{className:\"field-value\",children:student.nationality||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-field-display\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Mother Tongue\"}),/*#__PURE__*/_jsx(\"div\",{className:\"field-value\",children:student.motherTongue||'-'})]})]}),activeTab==='academic'&&/*#__PURE__*/_jsxs(\"div\",{className:\"tab-panel\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-field-display\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Admission Number\"}),/*#__PURE__*/_jsx(\"div\",{className:\"field-value\",children:student.admissionNumber||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-field-display\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Roll No\"}),/*#__PURE__*/_jsx(\"div\",{className:\"field-value\",children:student.rollNo||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-field-display\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Class\"}),/*#__PURE__*/_jsx(\"div\",{className:\"field-value\",children:student.gradeLevel||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-field-display\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Section\"}),/*#__PURE__*/_jsx(\"div\",{className:\"field-value\",children:student.section||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-field-display\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Academic Year\"}),/*#__PURE__*/_jsx(\"div\",{className:\"field-value\",children:student.academicYear||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-field-display\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Admission Date\"}),/*#__PURE__*/_jsx(\"div\",{className:\"field-value\",children:student.admissionDate||'-'})]})]}),activeTab==='contact'&&/*#__PURE__*/_jsxs(\"div\",{className:\"tab-panel\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-field-display\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Phone Number\"}),/*#__PURE__*/_jsx(\"div\",{className:\"field-value\",children:student.phoneNumber||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-field-display\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"School Email\"}),/*#__PURE__*/_jsx(\"div\",{className:\"field-value\",children:student.schoolEmail||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-field-display\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Personal Email\"}),/*#__PURE__*/_jsx(\"div\",{className:\"field-value\",children:student.personalEmail||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-field-display\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Address\"}),/*#__PURE__*/_jsx(\"div\",{className:\"field-value\",children:student.address||'-'})]})]}),activeTab==='guardian'&&/*#__PURE__*/_jsxs(\"div\",{className:\"tab-panel\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-field-display\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Guardian Name\"}),/*#__PURE__*/_jsx(\"div\",{className:\"field-value\",children:student.guardianName||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-field-display\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Relation\"}),/*#__PURE__*/_jsx(\"div\",{className:\"field-value\",children:student.guardianRelation||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-field-display\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Guardian Contact\"}),/*#__PURE__*/_jsx(\"div\",{className:\"field-value\",children:student.guardianContact||'-'})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"attendance-summary-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Attendance Summary\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"attendance-percentage\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"86%\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Overall attendance\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"attendance-bars\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"attendance-bar-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bar-label\",children:\"PRESENT\"}),/*#__PURE__*/_jsx(\"div\",{className:\"bar-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bar-fill present\",style:{width:'86%'}})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"attendance-bar-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bar-label\",children:\"ABSENT\"}),/*#__PURE__*/_jsx(\"div\",{className:\"bar-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bar-fill absent\",style:{width:'14%'}})})]})]})]})]})]});}","map":null,"metadata":{},"sourceType":"module"}